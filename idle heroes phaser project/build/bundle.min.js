!function e(t,i,a){function n(r,s){if(!i[r]){if(!t[r]){var l="function"==typeof require&&require;if(!s&&l)return l(r,!0);if(o)return o(r,!0);var c=new Error("Cannot find module '"+r+"'");throw c.code="MODULE_NOT_FOUND",c}var h=i[r]={exports:{}};t[r][0].call(h.exports,function(e){var i=t[r][1][e];return n(i||e)},h,h.exports,e,t,i,a)}return i[r].exports}for(var o="function"==typeof require&&require,r=0;r<a.length;r++)n(a[r]);return n}({1:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=function(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}({coin_burst_01:[{img:"logo.png"},{img:"cta.png"}],coin_cascade_05:[{img:"logo2.png"}]},"coin_cascade_05",[{img:"spin_button.png"},{img:"symbols.png"}])},{}],2:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var a=e("./pieces.js"),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(a);i.default={pieces:n.default}},{"./pieces.js":3}],3:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default={frames:{blue:{frame:{x:1,y:1,w:191,h:200},rotated:!1,trimmed:!0,spriteSourceSize:{x:2,y:0,w:191,h:200},sourceSize:{w:200,h:200}},green:{frame:{x:739,y:1,w:176,h:181},rotated:!1,trimmed:!0,spriteSourceSize:{x:9,y:9,w:176,h:181},sourceSize:{w:200,h:200}},purple:{frame:{x:372,y:1,w:174,h:200},rotated:!1,trimmed:!0,spriteSourceSize:{x:11,y:0,w:174,h:200},sourceSize:{w:200,h:200}},red:{frame:{x:548,y:1,w:189,h:190},rotated:!1,trimmed:!0,spriteSourceSize:{x:1,y:3,w:189,h:190},sourceSize:{w:200,h:200}},yellow:{frame:{x:194,y:1,w:176,h:200},rotated:!1,trimmed:!0,spriteSourceSize:{x:9,y:0,w:176,h:200},sourceSize:{w:200,h:200}}},meta:{app:"http://www.codeandweb.com/texturepacker",version:"1.0",image:"symbols.png",format:"RGBA8888",size:{w:916,h:202},scale:"1",smartupdate:"$TexturePacker:SmartUpdate:00ad39d14e57fb53f7dc0724b23f74d9:bd93cc0a483e18630e49c68728dfc8de:d295ed7153fe372207e34d26d380974a$"}}},{}],4:[function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}var n=e("./states/boot"),o=a(n),r=e("./states/endcard"),s=a(r),l=e("./states/preloader"),c=a(l),h=new Phaser.Game(document.body.clientWidth*window.devicePixelRatio,document.body.clientHeight*window.devicePixelRatio,Phaser.CANVAS,"game",null,!0);h.state.add("boot",new o.default),h.state.add("endcard",new s.default),h.state.add("preloader",new c.default),h.state.start("boot")},{"./states/boot":15,"./states/endcard":16,"./states/preloader":17}],5:[function(e,t,i){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),s=function(e){function t(e){a(this,t);var i=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.createVideoBackground(),i}return o(t,e),r(t,[{key:"createBackground",value:function(){var e=this.game.add.sprite(0,0,"background");this.add(e),this.game.global.windowHeight>this.game.global.windowWidth?(this.scale.x=this.game.global.windowHeight*window.devicePixelRatio/this.height*1.05,this.scale.y=this.scale.x,this.x=this.game.global.windowWidth*window.devicePixelRatio/2-this.width/2,this.y=this.game.global.windowHeight*window.devicePixelRatio/2-this.height/2-10):(this.scale.x=this.game.global.windowHeight*window.devicePixelRatio/this.height*1.05,this.scale.y=this.scale.x,this.x=this.game.global.windowWidth*window.devicePixelRatio/2-this.width/2-10,this.y=this.game.global.windowHeight*window.devicePixelRatio/2-this.height/2)}}]),t}(Phaser.Group);i.default=s},{}],6:[function(e,t,i){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),s=e("../prefabs/life-bar"),l=function(e){return e&&e.__esModule?e:{default:e}}(s),c=function(e){function t(e){a(this,t);var i=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));i.button=new Phaser.Sprite(e,0,0,"attack-button",0);var o=new Phaser.Sprite(e,0,0,"knight-portrait",0),r=new Phaser.Sprite(e,0,0,"girl-portrait",0);i.portrait={0:o,2:r,5:o},i.girlEnergyBar=new l.default(i.game,"girl-portrait",!1,0),i.enemyEnergyBar=new l.default(i.game,"death-icon",!0,0),i.add(i.button),i.add(i.girlEnergyBar),i.add(i.enemyEnergyBar),i.button.anchor.set(.5),i.button.x=i.game.global.windowWidth*window.devicePixelRatio/2,i.button.y=i.game.global.windowHeight*window.devicePixelRatio/2,i.game.global.windowHeight<i.game.global.windowWidth?(i.button.scale.x=i.game.global.windowWidth*window.devicePixelRatio*.3/i.button.width,i.girlEnergyBar.x=i.button.x/2+200,i.enemyEnergyBar.x=i.button.x/2+200,i.girlEnergyBar.scale.x=i.button.scale.x/2,i.girlEnergyBar.scale.y=i.button.scale.x/2,i.enemyEnergyBar.scale.x=i.button.scale.x/2,i.enemyEnergyBar.scale.y=i.button.scale.x/2):(i.button.scale.x=i.game.global.windowWidth*window.devicePixelRatio*.5/i.button.width,i.girlEnergyBar.x=i.button.x/2+100,i.enemyEnergyBar.x=i.button.x/2+100,i.girlEnergyBar.scale.x=i.button.scale.x/2.5,i.girlEnergyBar.scale.y=i.button.scale.y/2.5,i.enemyEnergyBar.scale.x=i.button.scale.x/2.5,i.enemyEnergyBar.scale.y=i.button.scale.y/2.5),i.button.scale.y=i.button.scale.x,i.idleAnimation(),i.button.alpha=0,i.girlEnergyBar.alpha=0,i.enemyEnergyBar.alpha=0,i.girlEnergyBar.y=i.button.y+150,i.enemyEnergyBar.y=i.button.y+250,i.initPortrait();var s={font:"18px "+PiecSettings.fontFamily},c=new Phaser.Text(i.game,0,0,"Power",s);c.x=i.girlEnergyBar.x,c.y=i.girlEnergyBar.y-50;var h=new Phaser.Text(i.game,0,0,"Power",s);return h.x=i.enemyEnergyBar.x,h.y=i.enemyEnergyBar.y-50,i.setTextColor(c),i.setTextColor(h),i.add(c),i.add(h),i.girlTextField=c,i.enemyTextField=h,i.girlTextField.alpha=0,i.enemyTextField.alpha=0,i}return o(t,e),r(t,[{key:"setTextColor",value:function(e){var t=e.context.createLinearGradient(0,0,0,e.height);t.addColorStop(0,"#ffffff"),t.addColorStop(1,"#dddddd"),e.fill=t,e.stroke="black"}},{key:"initPortrait",value:function(){for(var e in this.portrait){var t=this.portrait[e];this.add(t),t.anchor.set(.5),t.x=this.button.x-10,t.y=this.button.y-150,this.game.global.windowHeight<this.game.global.windowWidth?t.scale.x=this.game.global.windowWidth*window.devicePixelRatio*.3/t.width:t.scale.x=this.game.global.windowWidth*window.devicePixelRatio*.5/t.width,t.scale.y=t.scale.x,t.alpha=0}}},{key:"idleAnimation",value:function(){var e=this.button.scale.x;this.game.add.tween(this.button.scale).to({x:1.05*e,y:1.05*e},100,Phaser.Easing.Quadratic.InOut,!0,0).loop().yoyo(!0,0)}},{key:"hide",value:function(){var e=0;this.game.global.interaction>0&&(this.girlEnergyBar.increaseLifeBar(40),e=500),this.game.time.events.add(e,function(){this.game.add.tween(this.button).to({alpha:0},100,Phaser.Easing.Quadratic.InOut,!0,0);for(var e in this.portrait){var t=this.portrait[e];t&&0!=t.alpha&&this.game.add.tween(t).to({alpha:0},100,Phaser.Easing.Quadratic.InOut,!0,0)}this.girlEnergyBar&&0!=this.girlEnergyBar.alpha&&this.game.add.tween(this.girlEnergyBar).to({alpha:0},100,Phaser.Easing.Quadratic.InOut,!0,0),this.enemyEnergyBar&&0!=this.enemyEnergyBar.alpha&&this.game.add.tween(this.enemyEnergyBar).to({alpha:0},100,Phaser.Easing.Quadratic.InOut,!0,0),this.girlTextField&&0!=this.girlTextField.alpha&&this.game.add.tween(this.girlTextField).to({alpha:0},100,Phaser.Easing.Quadratic.InOut,!0,0),this.enemyTextField&&0!=this.enemyTextField.alpha&&this.game.add.tween(this.enemyTextField).to({alpha:0},100,Phaser.Easing.Quadratic.InOut,!0,0)},this)}},{key:"show",value:function(){this.game.add.tween(this.button).to({alpha:1},200,Phaser.Easing.Quadratic.InOut,!0,0)}},{key:"showWithCharacter",value:function(e,t){if(this.game.add.tween(this.button).to({alpha:1},200,Phaser.Easing.Quadratic.InOut,!0,0),this.game.add.tween(this.portrait[e]).to({alpha:1},200,Phaser.Easing.Quadratic.InOut,!0,0),this.game.add.tween(this.girlEnergyBar).to({alpha:1},200,Phaser.Easing.Quadratic.InOut,!0,0),this.game.add.tween(this.girlTextField).to({alpha:1},200,Phaser.Easing.Quadratic.InOut,!0,0),!PiecSettings.alwaysWin){var i=this.enemyEnergyBar;this.game.add.tween(i).to({alpha:1},200,Phaser.Easing.Quadratic.InOut,!0,0),this.game.add.tween(this.enemyTextField).to({alpha:1},200,Phaser.Easing.Quadratic.InOut,!0,0),i.increaseLifeBar(100,t)}}}]),t}(Phaser.Group);i.default=c},{"../prefabs/life-bar":12}],7:[function(e,t,i){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),s=function(e){function t(e,i){a(this,t);var o=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return o.pngSequencesLayer=i,o.game.global.interaction=0,o}return o(t,e),r(t,[{key:"runBattle",value:function(){var e,t=0;console.log("BATTLE RUNNING!!!");for(var i=0;i<PiecSettings.battleScript[this.game.global.interaction].length;i++)e=PiecSettings.battleScript[this.game.global.interaction][i],null!=e.delay&&(t+=e.delay),"attack"==e.a?this.game.global.characters[e.from].attackWithDelay(this.pngSequencesLayer,t,e.damage):"attackAndFly"==e.a&&this.game.global.characters[e.from].attackAndFlyToWithDelay(e.to,this.pngSequencesLayer,t,e.damage),null!=e.effect&&"shake"==e.effect?this.game.time.events.add(t+300,function(){this.game.camera.shake(.005,500)},this):null!=e.effect&&"shake-big"==e.effect&&this.game.time.events.add(t+300,function(){this.game.camera.shake(.005,900)},this);console.log(t),this.game.time.events.add(t,function(){this.game.onInteractionComplete.dispatch()},this)}},{key:"runEnemyAttack",value:function(){var e=0,t=PiecSettings.enemyAttackScript[0][0];null!=t.delay&&(e+=t.delay),"attack"==t.a?this.game.global.characters[t.from].attackWithDelay(this.pngSequencesLayer,e,t.damage):"attackAndFly"==t.a&&this.game.global.characters[t.from].attackAndFlyToWithDelay(t.to,this.pngSequencesLayer,e,t.damage),null!=t.effect&&"shake"==t.effect?this.game.time.events.add(e+300,function(){this.game.camera.shake(.005,500)},this):null!=t.effect&&"shake-big"==t.effect&&this.game.time.events.add(e+300,function(){this.game.camera.shake(.005,900)},this),console.log(e),this.game.time.events.add(e,function(){this.game.onInteractionComplete.dispatch()},this)}}]),t}(Phaser.Group);i.default=s},{}],8:[function(e,t,i){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),s=function(e){function t(e){a(this,t);var i=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));i.boundsPoint=new Phaser.Point(0,0),i.viewRect=new Phaser.Rectangle(0,0,i.game.width,i.game.height),i.gameWorld=i.game.add.group(),i.gameWorld.position.setTo(i.game.world.centerX,i.game.world.centerY),i.cameraGroup=i.game.add.group(i.gameWorld);return i.game.world.setBounds(-10,-10,i.game.world.width+10,i.game.world.height+10),i.settings={keyboardCtrl:!1,zoomSpeed:.05,panSpeed:5,panX:i.game.world.centerX,panY:i.game.world.centerY,zoomScale:1},i.gameWorld.scale.set(i.settings.zoomScale),i}return o(t,e),r(t,[{key:"enableKeyboardControl",value:function(){this.settings.keyboardCtrl=!0}},{key:"handleKeyboardMovement",value:function(){this.game.input.keyboard.isDown(Phaser.Keyboard.UP)?this.settings.panY-=5:this.game.input.keyboard.isDown(Phaser.Keyboard.DOWN)&&(this.settings.panY+=5),this.game.input.keyboard.isDown(Phaser.Keyboard.LEFT)?this.settings.panX-=5:this.game.input.keyboard.isDown(Phaser.Keyboard.RIGHT)&&(this.settings.panX+=5),this.game.input.keyboard.isDown(Phaser.Keyboard.Q)?this.settings.zoomScale+=.05:this.game.input.keyboard.isDown(Phaser.Keyboard.A)&&(this.settings.zoomScale-=.05)}},{key:"setZoom",value:function(e){this.settings.zoomScale=e}},{key:"setZoomSpeed",value:function(e){this.settings.zoomSpeed=e}},{key:"setPanSpeed",value:function(e){this.settings.panSpeed=e}},{key:"zoomTo",value:function(e,t,i){this.game.add.tween(this.settings).to({zoomScale:e},t,i,!0)}},{key:"panTo",value:function(e,t,i,a){this.game.add.tween(this.settings).to({panX:e+this.game.world.centerX,panY:t+this.game.world.centerY},i,a,!0)}},{key:"update",value:function(){!0===this.settings.keyboardCtrl&&this.handleKeyboardMovement(),this.gameWorld.scale.set(this.settings.zoomScale),this.gameWorld.pivot.x=this.settings.panX,this.gameWorld.pivot.y=this.settings.panY,this.cameraGroup.forEachExists(function(e){this.boundsPoint.setTo((e.x-this.gameWorld.pivot.x)*this.gameWorld.scale.x+.5*this.game.width,(e.y-this.gameWorld.pivot.y)*this.gameWorld.scale.y+.5*this.game.height),Phaser.Rectangle.containsPoint(this.viewRect,this.boundsPoint)?e.visible=!0:e.visible=!1},this)}}]),t}(Phaser.Group);i.default=s},{}],9:[function(e,t,i){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),s=e("../utils/custom-png-sequences-renderer.js"),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(s),c=e("../prefabs/life-bar"),h=function(e){return e&&e.__esModule?e:{default:e}}(c),u=function(e){function t(e,i){a(this,t);var o=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return o.characterSettings=i,o.createCharacter(),o.lifeBar=new h.default(o.game,i.icon,i.enemy),o.add(o.lifeBar),o.fitLifeBarInContainer(),o.dead=!1,o}return o(t,e),r(t,[{key:"createCharacter",value:function(){this.idleAnim=this.createAnimation(this.characterSettings.idleAnimIndex,!0),this.add(this.idleAnim),null==this.game.global.characterWidth&&(this.game.global.characterWidth=this.idleAnim.width)}},{key:"fitLifeBarInContainer",value:function(){null==this.game.global.lifeBarScale&&(this.game.global.lifeBarScale=this.idleAnim.width/this.lifeBar.width*.8),this.lifeBar.scale.x=this.game.global.lifeBarScale,this.lifeBar.scale.y=this.lifeBar.scale.x,this.lifeBar.x=this.idleAnim.x-this.lifeBar.width/3,this.lifeBar.y=this.idleAnim.y-this.idleAnim.height/2*this.characterSettings.lifeBarYPos}},{key:"attackWithDelay",value:function(e,t,i){this.game.time.events.add(t,function(){this.attack(e,i)},this)}},{key:"attack",value:function(e,t){this.idleAnim.visible=!1,this.attackAnim=this.createAnimation(this.characterSettings.attackAnimIndex,!1),this.add(this.attackAnim);var i=0;i=Math.floor(PiecSettings.pngAnimations[this.characterSettings.attackAnimIndex].spriteNumber*(1/PiecSettings.pngAnimations[this.characterSettings.attackAnimIndex].fps)*1e3)-150,this.game.time.events.add(i,function(){this.attackAnim.visible=!1,this.idleAnim.visible=!0},this),this.attackEffect(e,t)}},{key:"attackEffect",value:function(e,t){var i;i=this.characterSettings.flipped?PiecSettings.playerCharacters:PiecSettings.nonPlayerCharacters;for(var a=0;a<i.length;a++)if(!i[a].dead){var n=this.game.global.characters[i[a]];this.renderAttackEffect(n,e),n.decreaseLifeWithDelay(t,150)}}},{key:"attackAndFlyToWithDelay",value:function(e,t,i,a){this.game.time.events.add(i,function(){this.attackAndFlyTo(e,t,a)},this)}},{key:"attackAndFlyTo",value:function(e,t,i){var a=this.game.global.characters[e];console.log(a),this.idleAnim.visible=!1,this.attackAnim=this.createAnimation(this.characterSettings.attackAnimIndex,!1),this.add(this.attackAnim);var n,o=this.getXPos(),r=this.getYPos();n=this.characterSettings.flipped?this.game.add.tween(this.attackAnim).to({x:a.getXPos()+Math.abs(a.getWidth())/2,y:a.getYPos()},400,Phaser.Easing.Quadratic.Out,!0,0):this.game.add.tween(this.attackAnim).to({x:a.getXPos()-Math.abs(a.getWidth())/2,y:a.getYPos()},400,Phaser.Easing.Quadratic.Out,!0,0),this.bringCharacterToTop(),n.onComplete.add(function(){this.game.add.tween(this.attackAnim).to({x:o,y:r},400,Phaser.Easing.Quadratic.In,!0,0),this.reorderCharacters(),this.game.world.bringToTop(t)},this),this.game.time.events.add(800,function(){this.idleAnim.visible=!0,this.attackAnim.destroy()},this),null!=this.characterSettings.attackEffectAnimIndex&&this.renderAttackEffect(a,t),a.decreaseLifeWithDelay(i,150)}},{key:"renderAttackEffect",value:function(e,t){console.log(e);var i=l.playPngSequence(this.game,PiecSettings.pngAnimations[this.characterSettings.attackEffectAnimIndex],t);i.anchor.set(.5,1);var a=e.getYPos()+e.getHeight()-e.getHeight()/5;if("middle"==PiecSettings.pngAnimations[this.characterSettings.attackEffectAnimIndex].aligned&&(a=e.getYPos()+e.getHeight()/2),null!=this.characterSettings.attackEffectStyle&&"cast"==this.characterSettings.attackEffectStyle){i.x=this.getXPos(),i.y=this.getYPos()+this.getHeight()-this.getHeight()/5;this.game.add.tween(i).to({x:e.getXPos(),y:a},400,Phaser.Easing.Quadratic.InOut,!0,0)}else i.x=e.getXPos(),i.y=a;var n=1;null!=PiecSettings.pngAnimations[this.characterSettings.attackEffectAnimIndex].scale&&(n=PiecSettings.pngAnimations[this.characterSettings.attackEffectAnimIndex].scale),i.scale.x=this.game.global.characterWidth/i.width*1.1*n,i.scale.y=i.scale.x,i.animations.currentAnim.onComplete.add(function(){i.destroy()},this),this.game.world.bringToTop(t)}},{key:"createAnimation",value:function(e,t){var i=l.playPngSequence(this.game,PiecSettings.pngAnimations[e],this);i.x=this.game.global.windowWidth*window.devicePixelRatio*this.characterSettings.xPos,i.y=this.game.global.windowHeight*window.devicePixelRatio*this.characterSettings.yPos;var a=1;null!=PiecSettings.pngAnimations[e].scale&&(a=PiecSettings.pngAnimations[e].scale),this.game.global.windowHeight<this.game.global.windowWidth?i.scale.y=this.game.global.windowHeight*window.devicePixelRatio/i.height*this.characterSettings.scaleLandscape*a:i.scale.y=this.game.global.windowHeight*window.devicePixelRatio/i.height*this.characterSettings.scalePortrait*a,i.anchor.set(.5);var n=1;return this.characterSettings.flipped&&(n=-1),i.scale.x=i.scale.y*n,i}},{key:"decreaseLifeWithDelay",value:function(e,t){this.game.time.events.add(t,function(){this.lifeBar.decreaseLifeBarWithDelay(e,t),this.createAndAnimateText(e),this.game.time.events.add(Math.max(t,500),function(){!this.dead&&this.lifeBar.amount<=0&&null!=this.characterSettings.dieAnimIndex&&(console.log("what"),this.dieAnim=this.createAnimation(this.characterSettings.dieAnimIndex,!0),this.idleAnim&&(this.idleAnim.visible=!1),this.attackAnim&&(this.attackAnim.visible=!1),this.lifeBar.alpha=0,this.dead=!0)},this)},this)}},{key:"createAndAnimateText",value:function(e){e<0&&(e=1);var t=10*e+Math.round(50*Math.random()),i=1.5*this.lifeBar.height,a={font:"bold "+i+"px "+PiecSettings.fontFamily},n=new Phaser.Text(this.game,0,0,"-"+t,a);n.x=this.idleAnim.x-n.width/2,n.y=this.idleAnim.y;var o=n.context.createLinearGradient(0,0,0,n.height);o.addColorStop(0,"#ffffff"),o.addColorStop(1,"#dddddd"),n.fill=o,n.stroke="black",n.setShadow(2,3,"rgb(0,0,0)",0),this.add(n),this.game.add.tween(n).to({y:n.y-200},900,Phaser.Easing.Quadratic.In,!0,0),this.game.add.tween(n).to({alpha:0},500,Phaser.Easing.Quadratic.In,!0,400)}},{key:"bringCharacterToTop",value:function(){this.game.global.camera.gameWorld.bringToTop(this),this.game.global.camera.gameWorld.bringToTop(this.lifeBar)}},{key:"reorderCharacters",value:function(){for(var e=0;e<this.game.global.characters.length;e++)this.game.global.camera.gameWorld.bringToTop(this.game.global.characters[e]),this.game.global.camera.gameWorld.bringToTop(this.game.global.characters[e].lifeBar)}},{key:"getXPos",value:function(){return this.idleAnim.x}},{key:"getWidth",value:function(){return this.idleAnim.width}},{key:"getYPos",value:function(){return this.idleAnim.y}},{key:"getHeight",value:function(){return this.idleAnim.height}}]),t}(Phaser.Group);i.default=u},{"../prefabs/life-bar":12,"../utils/custom-png-sequences-renderer.js":19}],10:[function(e,t,i){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),s=e("../utils/custom-png-sequences-renderer.js"),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(s),c=function(e){function t(e){a(this,t);var i=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.button=new Phaser.Sprite(e,0,0,"cta",0),i.add(i.button),i.fitInContainer(),i.initialCtaWidth=i.button.width,i.button.inputEnabled=!0,i.button.input.useHandCursor=!0,i.button.events.onInputDown.add(function(){doSomething("download")}),i.game.global.windowHeight,i.game.global.windowWidth,i.trailLayer=i.game.add.group(),i.initialYPosition=i.y,i}return o(t,e),r(t,[{key:"applyMask",value:function(){var e=this.game.add.graphics(0,0);e.beginFill(16777215),e.drawRect(this.game.global.windowWidth/2*window.devicePixelRatio,0,this.game.global.windowWidth/2*window.devicePixelRatio,this.game.global.windowHeight*window.devicePixelRatio),this.mask=e}},{key:"fitInContainer",value:function(){this.container=document.getElementById("cta-container"),this.containerWidth=this.container.offsetWidth*window.devicePixelRatio,this.containerHeight=this.container.offsetHeight*window.devicePixelRatio;var e=this.container.getBoundingClientRect().left*window.devicePixelRatio,t=this.container.getBoundingClientRect().top*window.devicePixelRatio;this.x=e,this.y=t,this.scale.x=this.containerWidth/this.button.width,this.scale.y=this.scale.x}},{key:"playTrail",value:function(){var e=document.getElementById("trail-container"),t=e.offsetWidth*window.devicePixelRatio,i=e.offsetHeight*window.devicePixelRatio,a=e.getBoundingClientRect().left*window.devicePixelRatio,n=e.getBoundingClientRect().top*window.devicePixelRatio;console.log(a),console.log(n),console.log(t),console.log(i);l.playPngSequence(this.game,PiecSettings.pngAnimations[1],this.trailLayer);this.trailLayer.alpha=.7,this.game.time.events.add(700,function(){this.vibrate()},this)}},{key:"vibrate",value:function(){this.game.add.tween(this).to({y:this.initialYPosition+30},150,Phaser.Easing.Quadratic.InOut,!0,0).onComplete.add(function(){this.game.add.tween(this).to({y:this.initialYPosition},150,Phaser.Easing.Quadratic.InOut,!0,0)},this),this.game.camera.shake(.007,100)}},{key:"animate",value:function(){var e=document.getElementById("cta-container-final"),t=e.offsetWidth*window.devicePixelRatio,i=e.getBoundingClientRect().left*window.devicePixelRatio,a=e.getBoundingClientRect().top*window.devicePixelRatio;this.newScale=t/this.initialCtaWidth;this.game.add.tween(this).to({x:i,y:a},1400,Phaser.Easing.Back.InOut,!0,0),this.game.add.tween(this.scale).to({x:this.newScale,y:this.newScale},1400,Phaser.Easing.Back.InOut,!0,0);this.game.time.events.add(1400,function(){this.startPulseIdleAnimation()},this)}},{key:"startPulseIdleAnimation",value:function(){var e=document.getElementById("cta-container-final-2"),t=e.offsetWidth*window.devicePixelRatio,i=e.getBoundingClientRect().left*window.devicePixelRatio,a=e.getBoundingClientRect().top*window.devicePixelRatio,n=t/this.initialCtaWidth;this.game.add.tween(this.scale).to({x:n,y:n},1e3,Phaser.Easing.Quadratic.InOut,!0,0,-1,!0),this.game.add.tween(this).to({x:i,y:a},1e3,Phaser.Easing.Quadratic.InOut,!0,0,-1,!0)}}]),t}(Phaser.Group);i.default=c},{"../utils/custom-png-sequences-renderer.js":19}],11:[function(e,t,i){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),s=function(e){function t(e){a(this,t);var i=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.graphics=e.add.graphics(0,0),null!=PiecSettings.finalOverlay&&null!=PiecSettings.finalOverlay.color?i.graphics.beginFill(PiecSettings.finalOverlay.color,1):i.graphics.beginFill(0,1),i.graphics.drawRect(0,0,i.game.global.windowWidth*window.devicePixelRatio,i.game.global.windowHeight*window.devicePixelRatio),i.add(i.graphics),null!=PiecSettings.finalOverlay&&null!=PiecSettings.finalOverlay.alpha?i.finalAlpha=PiecSettings.finalOverlay.alpha:i.finalAlpha=.5,i.alpha=0,i.createGradient(),i}return o(t,e),r(t,[{key:"createGradient",value:function(){var e=this.game.add.sprite(0,0,"gradient");e.scale.x=this.game.global.windowWidth*window.devicePixelRatio/e.width*1.1,e.scale.y=this.game.global.windowHeight*window.devicePixelRatio*.25/e.height,e.y=this.game.global.windowHeight*window.devicePixelRatio*1.01-e.height,e.x=-.01*e.width}},{key:"show",value:function(){this.game.add.tween(this).to({alpha:this.finalAlpha},1200,Phaser.Easing.Quadratic.In,!0,0)}},{key:"showDuringBattle",value:function(){this.game.add.tween(this).to({alpha:this.finalAlpha},100,Phaser.Easing.Quadratic.In,!0,0)}},{key:"hide",value:function(){if(this.alpha>0){this.game.add.tween(this).to({alpha:0},1e3,Phaser.Easing.Quadratic.In,!0,0)}}},{key:"hideDuringBattle",value:function(){if(this.alpha>0){this.game.add.tween(this).to({alpha:0},800,Phaser.Easing.Quadratic.In,!0,0)}}}]),t}(Phaser.Group);i.default=s},{}],12:[function(e,t,i){"use strict";function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),l=e("../utils/util"),c=(a(l),e("../utils/custom-png-sequences-renderer.js")),h=(a(c),function(e){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments[3];n(this,t);var s=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return s.createLifeBar(a,r),s.amount=null!=r?r:100,s.initialWidth,""!=i&&s.createIcon(i),s}return r(t,e),s(t,[{key:"createIcon",value:function(e){var t=this.game.add.sprite(0,0,e);this.add(t),"girl-portrait"!=e?(t.anchor.set(.5),t.x=-1*t.width/2*1.5,t.y=this.initialHeight/2,t.scale.y=this.initialHeight/t.height*1.5,t.scale.x=t.scale.y):(t.x=-1*t.width/2*1.3,t.y=this.initialHeight/2-150,t.scale.y=this.initialHeight/t.height*5,t.scale.x=.8*t.scale.y)}},{key:"createLifeBar",value:function(e,t){var i=this.game.add.sprite(0,0,"bar-bg");this.add(i);var a="bar-fill";e&&(a="enemy-bar-fill")
;var n=this.game.add.sprite(0,0,a);this.add(n),n.x=this.width/100,n.y=this.height/100*7,n.x=this.width/100,n.y=this.height/100*7,n.scale.x=(this.width-this.width/100*2)/n.width,n.scale.y=i.height/n.height*.85,this.fullWidthFilling=n.scale.x,0==t&&(n.scale.x=0),this.initialWidth=this.width,this.initialHeight=this.height,this.barFilling=n}},{key:"decreaseLifeBar",value:function(e){this.amount-e>0?this.amount-=e:this.amount=0;this.game.add.tween(this.barFilling.scale).to({x:this.fullWidthFilling*(this.amount/100)},300,Phaser.Easing.Quadratic.InOut,!0,0)}},{key:"increaseLifeBar",value:function(e,t){console.log("increase: "+e),this.amount+=e,this.amount=this.amount<100?this.amount:100;var i=t||300;this.game.add.tween(this.barFilling.scale).to({x:this.fullWidthFilling*(this.amount/100)},i,Phaser.Easing.Quadratic.InOut,!0,0)}},{key:"decreaseLifeBarWithDelay",value:function(e,t){this.game.time.events.add(t,function(){this.decreaseLifeBar(e)},this)}}]),t}(Phaser.Group));i.default=h},{"../utils/custom-png-sequences-renderer.js":19,"../utils/util":20}],13:[function(e,t,i){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),s=function(e){function t(e){a(this,t);var i=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));i.container=document.getElementById("logo");var o=i.container.offsetWidth*window.devicePixelRatio,r=(i.container.offsetHeight,window.devicePixelRatio,i.container.getBoundingClientRect().left*window.devicePixelRatio),s=i.container.getBoundingClientRect().top*window.devicePixelRatio;return i.logo=i.game.add.sprite(0,0,"logo"),i.logo.anchor.set(.5,.5),i.add(i.logo),i.game.global.windowHeight<i.game.global.windowWidth?(i.initialLogoWidth=i.logo.width,i.initialLogoHeight=i.logo.height):(i.initialLogoWidth=i.logo.width/1.5,i.initialLogoHeight=i.logo.height/1.5),i.logo.scale.x=o/i.initialLogoWidth,i.initialLogoScale=i.logo.scale.x,i.logo.scale.y=i.logo.scale.x,i.logo.x=r+i.logo.width/2,i.logo.y=s+i.logo.height/2,i.alpha=1,i}return o(t,e),r(t,[{key:"animate",value:function(){var e=document.getElementById("logo-final"),t=e.offsetWidth*window.devicePixelRatio,i=e.getBoundingClientRect().left*window.devicePixelRatio,a=e.getBoundingClientRect().top*window.devicePixelRatio,n=t/this.initialLogoWidth;this.game.add.tween(this.logo.scale).to({x:n,y:n},1e3,Phaser.Easing.Quadratic.InOut,!0,0),this.game.add.tween(this.logo).to({x:i+this.initialLogoWidth*n/2,y:a+this.initialLogoHeight*n/2},1400,Phaser.Easing.Quadratic.InOut,!0,0),this.game.add.tween(this.logo).to({angle:360},1e3,Phaser.Easing.Back.InOut,!0,0)}}]),t}(Phaser.Group);i.default=s},{}],14:[function(e,t,i){"use strict";function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),l=e("../utils/util"),c=(a(l),e("../utils/custom-png-sequences-renderer.js")),h=(a(c),function(e){function t(e){return n(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return r(t,e),s(t,[{key:"showWinMessage",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=document.getElementById("win-message"),a=i.offsetWidth*window.devicePixelRatio,n=(i.offsetHeight,window.devicePixelRatio,i.getBoundingClientRect().left*window.devicePixelRatio),o=i.getBoundingClientRect().top*window.devicePixelRatio,r=document.getElementById("tryAgain");t?(e=this.game.add.sprite(0,0,"lose-message"),this.game.time.events.add(2e3,function(){r.classList+=" show"},this),console.log("lose")):e=this.game.add.sprite(0,0,"win-message"),e.anchor.set(.5),e.scale.x=a/e.width,e.scale.y=e.scale.x,e.x=n+e.width/2,e.y=o+e.height/2;var s=e.scale.x;e.scale.x=.01,e.scale.y=.01;this.game.add.tween(e.scale).to({x:s,y:s},700,Phaser.Easing.Back.Out,!0,0);this.game.time.events.add(1100,function(){this.game.add.tween(e).to({y:window.innerHeight*window.devicePixelRatio+e.height},700,Phaser.Easing.Linear.InOut,!0,0)},this)}},{key:"animate",value:function(){this.gingerbread.alpha=1;var e=this.gingerbread.y;this.gingerbread.y=window.innerHeight*window.devicePixelRatio;this.game.add.tween(this.gingerbread).to({y:e},2e3,Phaser.Easing.Back.InOut,!0,0)}}]),t}(Phaser.Group));i.default=h},{"../utils/custom-png-sequences-renderer.js":19,"../utils/util":20}],15:[function(e,t,i){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),s=function(e){function t(){return a(this,t),n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return o(t,e),r(t,[{key:"preload",value:function(){}},{key:"init",value:function(){PiecSettings.assetsDir="dev"===PiecSettings.env?"assets/":"";var e=this.game;e.onGameComplete=new Phaser.Signal,e.onCompleteLevel=new Phaser.Signal,e.onInteract=new Phaser.Signal,e.onInteractionComplete=new Phaser.Signal,"undefined"!=typeof piec&&(piec.lockGame=function(){e.global.locked=!0},piec.unlockGame=function(){e.global.locked=!1},piec.completeLevel=function(){e.onCompleteLevel.dispatch()},piec.destroyGame=function(){e.destroy()},piec.spin=function(){e.onSpin.dispatch()},piec.onInteract=function(){e.onInteract.dispatch()}),piec.restartLevel=function(){e.state.start("endcard"),e.global.restarted=!0,piec.unlockGame(),e.global.interaction=0,e.global.isComplete=!1},window.onresize=function(){var t=e.state.states[e.state.current];t.resize&&t.resize(),"undefined"!=typeof piec&&piec.onResize()}}},{key:"create",value:function(){this.init(),this.game.input.maxPointers=1,this.initGlobalVariables(),this.game.state.start("preloader"),this.game.onMoveStart=function(e){e.global.interactions++,PiecSettings&&PiecSettings.onMoveStart&&PiecSettings.onMoveStart(e.global.interactions)},this.game.onMoveComplete=function(e){PiecSettings&&PiecSettings.onMoveComplete&&PiecSettings.onMoveComplete(e.global.moveStats)}}},{key:"initGlobalVariables",value:function(){this.game.global={reelsSpinCompleted:0,isComplete:!1}}}]),t}(Phaser.State);i.default=s},{}],16:[function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),l=e("../prefabs/logo"),c=a(l),h=e("../prefabs/dark-overlay"),u=a(h),d=e("../prefabs/cta-button"),g=a(d),f=e("../prefabs/victory"),p=a(f),m=e("../prefabs/character"),y=a(m),b=e("../prefabs/background"),w=(a(b),e("../prefabs/battle-button")),v=a(w),P=e("../prefabs/battle-controller"),x=a(P),S=e("../prefabs/camera"),O=a(S),_=e("../utils/custom-png-sequences-renderer.js"),k=(function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);t.default=e}(_),function(e){function t(){return n(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return r(t,e),s(t,[{key:"create",value:function(){this.game.scale.scaleMode=Phaser.ScaleManager.USER_SCALE,this.game.scale.setUserScale(1/window.devicePixelRatio,1/window.devicePixelRatio,0,0),this.game.global.windowHeight=document.body.clientHeight,this.game.global.windowWidth=document.body.clientWidth,this.camera=new O.default(this.game),this.camera.setZoom(1.2),this.game.global.camera=this.camera,this.game.onInteract.add(this.onInteract,this),this.game.onInteractionComplete.add(this.onInteractionComplete,this),this.game.global.characters=[],this.characters=[];for(var e=0;e<PiecSettings.characterSettings.length;e++){var t=new y.default(this.game,PiecSettings.characterSettings[e]);this.characters.push(t),this.game.global.characters.push(t),this.camera.gameWorld.add(t)}this.pngSequencesLayer=this.game.add.group(),this.battleController=new x.default(this.game,this.pngSequencesLayer),this.battleController.runBattle(),this.darkOverlay=new u.default(this.game),this.game.add.existing(this.darkOverlay),this.victory=new p.default(this.game),this.game.add.existing(this.victory),this.logo=new c.default(this.game),this.game.add.existing(this.logo),this.cta=new g.default(this.game),this.game.add.existing(this.cta),this.battleButton=new v.default(this.game),this.game.add.existing(this.battleButton),null!=PiecSettings.closeButtonTimer&&0!=PiecSettings.closeButtonTimer||(document.getElementById("vungle-close").className="show visible"),this.game.global.readyToInteract=!1,this.camera.zoomTo(1,3e3,Phaser.Easing.Quadratic.Out),this.videoList=PiecSettings.videos,this.video=document.getElementById("videoBg"),this.source=document.createElement("source"),this.setVideoName(this.videoList.intro),this.video.appendChild(this.source),this.video.play()}},{key:"resize",value:function(){location.reload()}},{key:"render",value:function(){}},{key:"setVideoName",value:function(e){var t;t=""!=e?PiecSettings.assetsDir+e+".mp4":"",this.source.setAttribute("src",t),console.log(t)}},{key:"onInteract",value:function(){this.setVideoName(this.videoList.path),this.video.load(),this.video.play(),PiecSettings.alwaysWin=!0,this.game.time.events.remove(this.timer),null!=PiecSettings.closeButtonTimer&&1==PiecSettings.closeButtonTimer&&(document.getElementById("vungle-close").className="show visible"),console.log("interaction! "+this.game.global.readyToInteract),this.game.global.isComplete||this.game.global.readyToInteract&&this.game.global.interaction<PiecSettings.battleScript.length&&(this.game.global.interaction++,this.battleController.runBattle(),this.game.global.readyToInteract=!1,this.battleButton.hide(),this.darkOverlay.hideDuringBattle(),this.game.global.interaction==PiecSettings.battleScript.length-1&&(this.game.global.isComplete=!0))}},{key:"enemyAttack",value:function(){this.game.global.isComplete||(this.battleController.runEnemyAttack(),this.game.global.readyToInteract=!1,this.battleButton.hide(),this.darkOverlay.hideDuringBattle(),this.game.global.isComplete=!0)}},{key:"onInteractionComplete",value:function(){this.game.global.restarted&&(this.lose=!1,this.game.global.restarted=!1);var e=1e3;0==PiecSettings.battleScript[this.game.global.interaction].length&&(e=0),this.video.pause(),this.game.time.events.add(e,function(){if(this.game.global.readyToInteract=!0,this.game.global.interaction<PiecSettings.battleScript.length-1&&!this.lose){var e=PiecSettings.battleScript[this.game.global.interaction+1][0];this.isEnemy(e.from)?this.game.global.readyToInteract&&this.game.onInteract.dispatch():(this.battleButton.showWithCharacter(e.from,PiecSettings.autoPlay.activateAfter),this.darkOverlay.showDuringBattle()),this.game.world.bringToTop(this.battleButton),null!=PiecSettings.autoPlay&&(null!=PiecSettings.autoPlay.activateAfter?PiecSettings.alwaysWin?this.timer=this.game.time.events.add(PiecSettings.autoPlay.activateAfter,function(){console.log("RESET THE TIMER"),this.game.global.readyToInteract&&this.game.onInteract.dispatch()},this):this.timer=this.game.time.events.add(PiecSettings.autoPlay.activateAfter,function(){null!=PiecSettings.closeButtonTimer&&1==PiecSettings.closeButtonTimer&&(document.getElementById("vungle-close").className="visible"),this.lose=!0,this.game.global.readyToInteract&&this.enemyAttack()},this):this.game.onSpin.dispatch())}else this.victory.showWinMessage(this.lose),this.game.time.events.add(1e3,function(){this.darkOverlay.show(),this.game.world.bringToTop(this.darkOverlay),this.game.world.bringToTop(this.logo),this.logo.animate(),this.game.world.bringToTop(this.cta),this.cta.animate()},this)},this)}},{key:"isEnemy",value:function(e){for(var t=!0,i=0;i<PiecSettings.playerCharacters.length;i++)e==PiecSettings.playerCharacters[i]&&(t=!1);return t}}]),t}(Phaser.State));i.default=k},{"../prefabs/background":5,"../prefabs/battle-button":6,"../prefabs/battle-controller":7,"../prefabs/camera":8,"../prefabs/character":9,"../prefabs/cta-button":10,"../prefabs/dark-overlay":11,"../prefabs/logo":13,"../prefabs/victory":14,"../utils/custom-png-sequences-renderer.js":19}],17:[function(e,t,i){"use strict";function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),l=e("../atlas/index"),c=(a(l),e("../utils/util")),h=(a(c),e("../animations.js")),u=(a(h),e("../utils/custom-png-sequences-renderer.js")),d=a(u),g=function(e){function t(){n(this,t);var e=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.asset=null,e}return r(t,e),s(t,[{key:"preload",value:function(){this.load.onLoadComplete.addOnce(this.onLoadComplete,this),this.loadResources(),d.preloadPngSequences(this.game)}},{key:"update",value:function(){}},{key:"loadResources",value:function(){this.game.load.image("logo",PiecSettings.assetsDir+"logo.png"),this.game.load.image("cta",PiecSettings.assetsDir+"cta.png"),this.game.load.image("win-message",PiecSettings.assetsDir+"victory.png"),this.game.load.image("bar-bg",PiecSettings.assetsDir+"enemy_bar_bg.png"),this.game.load.image("bar-fill",PiecSettings.assetsDir+"good_bar_fill.png"),this.game.load.image("enemy-bar-fill",PiecSettings.assetsDir+"enemy_bar_fill.png"),this.game.load.image("background",PiecSettings.assetsDir+"bg.jpg"),this.game.load.image("gradient",PiecSettings.assetsDir+"gradient.png"),this.game.load.image("blue-icon",PiecSettings.assetsDir+"blue_icon.png"),this.game.load.image("death-icon",PiecSettings.assetsDir+"death_icon.png"),this.game.load.image("purple-icon",PiecSettings.assetsDir+"purple_icon.png"),this.game.load.image("win-message",PiecSettings.assetsDir+"victory.png"),this.game.load.image("lose-message",PiecSettings.assetsDir+"lose.png"),this.game.load.image("knight-portrait",PiecSettings.assetsDir+"knight_portrait.png"),this.game.load.image("girl-portrait",PiecSettings.assetsDir+"girl_portrait.png"),this.game.load.image("attack-button",PiecSettings.assetsDir+"attack.png"),this.game.global.animations={},PiecSettings.animation=PiecSettings.animation||{}}},{key:"onLoadComplete",value:function(){this.game.state.start("endcard")}}]),t}(Phaser.State);i.default=g},{"../animations.js":1,"../atlas/index":2,"../utils/custom-png-sequences-renderer.js":19,"../utils/util":20}],18:[function(e,t,i){"use strict";function a(e,t){e.loopReverse&&(e.animations.currentAnim.isReversed=!0),1==e.numberOfLoops?e.persistent?t.loop=!1:(t.loop=!1,e.alpha=0):0!=t.loopCount&&t.loopCount===e.numberOfLoops-1&&(e.persistent?t.loop=!1:(t.loop=!1,e.alpha=0))}function n(e,t,i,a,n,r){t.loopReverse=r,t.speed=a,t.loopReverse?e.time.events.add(i,function(){t.alpha=1,t.animations.play("animation",a,!1),t.animations.currentAnim.onComplete.add(o,this)}):e.time.events.add(i,function(){console.log("play animation "+n),t.alpha=1,t.animations.play("animation",a,n)})}function o(e,t){e.animations.currentAnim.isReversed=!e.animations.currentAnim.isReversed,e.animations.play("animation",e.speed,!1)}function r(e,t,i,a,o,r,s,l,c,h,u,d){for(var g=h.offsetWidth*window.devicePixelRatio,f=h.offsetHeight*window.devicePixelRatio,p=h.offsetLeft*window.devicePixelRatio,m=h.offsetTop*window.devicePixelRatio,y=g/100,b=f/100,w=[],v=0;v<t.length;v++){var P=u.add.sprite(p+t[v]*y,m+i[v]*b,e);d.add(P),P.anchor.set(r),P.animations.add("animation"),P.alpha=0,P.persistent=c,console.log("calling play animation, with loops "+o),n(u,P,a[v],s,1!=o,!1),P.scale.x=g*l[v]/100/P.width,P.scale.y=P.scale.x,w.push(P)}return w}Object.defineProperty(i,"__esModule",{value:!0}),i.onLoop=a,i.playAnimation=n,i.onComplete=o,i.playAnimations=r},{}],19:[function(e,t,i){"use strict";function a(e){if(null!=PiecSettings.pngAnimations)for(var t=0;t<PiecSettings.pngAnimations.length;t++){var i=PiecSettings.pngAnimations[t];n(e,i)}}function n(e,t){var i=t.src.substr(0,t.src.indexOf("."));e.load.spritesheet(i,PiecSettings.assetsDir+t.src,t.spriteWidth,t.spriteHeight,t.spriteNumber)}function o(e,t,i){var a=t.src.substr(0,t.src.indexOf("."));if(null!=t.htmlContainer)var n=document.getElementById(t.htmlContainer),o=n.offsetWidth*window.devicePixelRatio,r=(n.offsetHeight,window.devicePixelRatio,n.getBoundingClientRect().left*window.devicePixelRatio),l=n.getBoundingClientRect().top*window.devicePixelRatio;var c=e.add.sprite(r,l,a);if(i.add(c),c.animations.add("animation"),c.anchor.set(0,0),c.alpha=0,null==t.loopReverse&&(t.loopReverse=!1),null!=t.isReversed&&t.isReversed&&(c.animations.currentAnim.isReversed=!0),s.playAnimation(e,c,t.delay,t.fps,1!=t.loops,t.loopReverse),null!=t.angle&&0!=t.angle){var h=0;this.game.global.windowWidth>this.game.global.windowHeight&&null!=t.responsiveAngle&&t.responsiveAngle&&(h=90),c.anchor.set(.5),c.angle=t.angle+h}if(null!=t.htmlContainer&&(c.scale.x=o/c.width,c.scale.y=c.scale.x,c.persistent=!1),null!=t.persistent&&(c.persistent=t.persistent),null!=t.loops&&(c.numberOfLoops=t.loops,c.animations.currentAnim.onLoop.add(s.onLoop,this)),null!=t.effect&&-1!=t.effect.indexOf("fade-in")){c.alpha=0;e.add.tween(c).to({alpha:1},1e3,Phaser.Easing.Linear.None,!0,t.delay)}return c}Object.defineProperty(i,"__esModule",{value:!0}),i.preloadPngSequences=a,i.playPngSequence=o;var r=e("../utils/animations-util.js"),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(r)},{"../utils/animations-util.js":18}],20:[function(e,t,i){"use strict";function a(e,t){return t||(t=0),Math.floor(Math.random()*(e-t+1))+t}function n(e){return e[this.rndInt(e.length-1,0)]}function o(e){return e||(e=1),"rgba("+this.rndInt(256)+","+this.rndInt(256)+","+this.rndInt(256)+","+e+")"}function r(){return document.body.clientHeight>document.body.clientWidth}function s(e){return JSON.parse(JSON.stringify(e))}function l(e,t){var i=e.indexOf(t);i>-1&&e.splice(i,1)}function c(e){return-1===e.lastIndexOf(".")?e:e.substring(0,e.lastIndexOf("."))}function h(e){e.style.opacity=0;var t=+new Date;!function i(){e.style.opacity=+e.style.opacity+(new Date-t)/400,t=+new Date,+e.style.opacity<1&&(window.requestAnimationFrame&&requestAnimationFrame(i)||setTimeout(i,16))}()}function u(e){return 100*Math.sqrt(2*Math.abs(e)/m)}function d(e){var t={boolean:{},number:{},string:{}},i=[];return e.filter(function(e){var a=void 0===e?"undefined":p(e);return a in t?!t[a].hasOwnProperty(e)&&(t[a][e]=!0):!(i.indexOf(e)>=0)&&i.push(e)})}function g(e,t){var i,a={};for(i in e)Object.prototype.hasOwnProperty.call(e,i)&&(a[i]=e[i]);for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&(a[i]=t[i]);return a}function f(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}Object.defineProperty(i,"__esModule",{value:!0});var p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};i.rndInt=a,i.sample=n,i.rndRgba=o,i.isPortrait=r,i.clone=s,i.remove=l,i.removeExtension=c,i.fadeIn=h,i.calcQuadTime=u,i.uniq=d,i.extend=g,i.numberWithCommas=f;var m=19.8},{}]},{},[4]);
